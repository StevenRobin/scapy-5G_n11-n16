2025-05-20 19:13:10,473 - INFO - [MainThread] 开始处理文件 pcap/N16_create_16p.pcap
2025-05-20 19:13:10,477 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,477 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,478 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,478 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,479 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,479 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,480 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,480 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,481 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,481 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,482 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,482 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,482 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,483 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,483 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,484 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,485 - INFO - [MainThread] 特殊处理第9个报文
2025-05-20 19:13:10,485 - INFO - [MainThread] 处理第9个报文的第1个HEADERS帧
2025-05-20 19:13:10,485 - INFO - [MainThread] 对第9个报文使用二进制替换方法
2025-05-20 19:13:10,486 - INFO - [MainThread] 替换:authority: 200.20.20.25:8080 -> 30.0.0.1
2025-05-20 19:13:10,486 - INFO - [MainThread] 替换:path: /nsmf-pdusession/v1/sm-contexts/1722077971/retrieve -> /nsmf-pdusession/v1/sm-contexts/9000000001/retrieve
2025-05-20 19:13:10,486 - INFO - [MainThread] HEADERS已修改，新长度: 64
2025-05-20 19:13:10,487 - INFO - [MainThread] 第9个报文已通过帧处理修改
2025-05-20 19:13:10,487 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,487 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,488 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,489 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,490 - INFO - [MainThread] 特殊处理第11个报文
2025-05-20 19:13:10,490 - INFO - [MainThread] 处理第11个报文的第0个HEADERS帧
2025-05-20 19:13:10,490 - INFO - [MainThread] 对第11个报文使用二进制替换方法
2025-05-20 19:13:10,490 - INFO - [MainThread] 特殊处理第11号报文
2025-05-20 19:13:10,490 - INFO - [MainThread] 使用额外的强制替换方法确保authority字段正确
2025-05-20 19:13:10,491 - INFO - [MainThread] 替换 dnn: dnn-0000 -> dnn600000001
2025-05-20 19:13:10,491 - INFO - [MainThread] 替换 gpsi: msisdn-8611111111111 -> msisdn-8613900000001
2025-05-20 19:13:10,491 - INFO - [MainThread] 替换 ueIpv4Address: 30.30.30.20 -> 100.0.0.1
2025-05-20 19:13:10,491 - INFO - [MainThread] JSON数据已修改
2025-05-20 19:13:10,491 - INFO - [MainThread] 第11个报文DATA帧已修改，新长度: 350
2025-05-20 19:13:10,492 - INFO - [MainThread] 更新Content-Length: 348 -> 350
2025-05-20 19:13:10,492 - INFO - [MainThread] 第11个报文的content-length已更新
2025-05-20 19:13:10,492 - INFO - [MainThread] 第11个报文已通过帧处理修改
2025-05-20 19:13:10,492 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,492 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,493 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,493 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,494 - INFO - [MainThread] 特殊处理第13个报文
2025-05-20 19:13:10,494 - INFO - [MainThread] 处理第13个报文的第0个HEADERS帧
2025-05-20 19:13:10,494 - INFO - [MainThread] 对第13个报文使用二进制替换方法
2025-05-20 19:13:10,494 - INFO - [MainThread] 特殊处理第13号报文 - 确保content-type存在且头部正确
2025-05-20 19:13:10,494 - INFO - [MainThread] 添加默认content-type: application/json
2025-05-20 19:13:10,494 - INFO - [MainThread] 为第13号报文创建了最小化头部，新长度: 48
2025-05-20 19:13:10,494 - ERROR - [MainThread] 解析HEADERS错误: Invalid table index 63
2025-05-20 19:13:10,495 - INFO - [MainThread] 替换 supi: imsi-460011357924680 -> imsi-460012300000001
2025-05-20 19:13:10,495 - INFO - [MainThread] 替换 pei: imeisv-8611111111111111 -> imeisv-8611101000000011
2025-05-20 19:13:10,495 - INFO - [MainThread] 替换 dnn: dnn-0000 -> dnn600000001
2025-05-20 19:13:10,495 - INFO - [MainThread] 替换 ismfId: c251849c-681e-48ba-918b-ae0200867718 -> c251849c-681e-48ba-918b-000500000001
2025-05-20 19:13:10,495 - INFO - [MainThread] 替换 ismfPduSessionUri: http://200.20.20.26:8080/nsmf-pdusession/v1/pdu-sessions/461977034 -> http://40.0.0.1:80/nsmf-pdusession/v1/pdu-sessions/10000001
2025-05-20 19:13:10,495 - INFO - [MainThread] 替换 icnTunnelInfo: {'ipv4Addr': '30.0.0.3', 'gtpTeid': '00000001'} -> {'ipv4Addr': '10.0.0.1', 'gtpTeid': '10000001'}
2025-05-20 19:13:10,496 - INFO - [MainThread] 替换 nrCellId: 00011c006 -> 010000001
2025-05-20 19:13:10,496 - INFO - [MainThread] 替换 gpsi: msisdn-8611111111111 -> msisdn-8613900000001
2025-05-20 19:13:10,496 - INFO - [MainThread] JSON数据已修改
2025-05-20 19:13:10,496 - INFO - [MainThread] 第13个报文DATA帧已修改，新长度: 706
2025-05-20 19:13:10,496 - INFO - [MainThread] 在第13个报文的HEADERS帧中添加缺失的content-length字段
2025-05-20 19:13:10,496 - INFO - [MainThread] 添加Content-Length: 706
2025-05-20 19:13:10,496 - INFO - [MainThread] 已在第13个报文中添加content-length: 706
2025-05-20 19:13:10,496 - INFO - [MainThread] 第13个报文已通过帧处理修改
2025-05-20 19:13:10,497 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,497 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,497 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,497 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,498 - INFO - [MainThread] =========== 修改前第15号报文原始值 ===========
2025-05-20 19:13:10,498 - INFO - [MainThread] 修改前第15号报文未找到location字段
2025-05-20 19:13:10,498 - INFO - [MainThread] 修改前第15号报文未找到content-length字段
2025-05-20 19:13:10,498 - INFO - [MainThread] 检查修改前第15号报文的第0个HEADERS帧
2025-05-20 19:13:10,498 - ERROR - [MainThread] 修改前HEADERS解码失败: Invalid table index 63
2025-05-20 19:13:10,498 - INFO - [MainThread] 修改前第15号报文DATA帧长度: 353
2025-05-20 19:13:10,499 - INFO - [MainThread] 修改前第15号报文DATA帧长度: 0
2025-05-20 19:13:10,499 - INFO - [MainThread] =========== 修改前第15号报文调试信息结束 ===========
2025-05-20 19:13:10,499 - INFO - [MainThread] 特殊处理第15个报文
2025-05-20 19:13:10,499 - INFO - [MainThread] ===== 第15号报文调试信息开始 =====
2025-05-20 19:13:10,500 - INFO - [MainThread] 原始第15号报文未找到location字段
2025-05-20 19:13:10,500 - INFO - [MainThread] 原始第15号报文未找到content-length字段
2025-05-20 19:13:10,500 - INFO - [MainThread] 检查第15号报文的第0个HEADERS帧
2025-05-20 19:13:10,500 - ERROR - [MainThread] HEADERS解码失败: Invalid table index 63
2025-05-20 19:13:10,500 - INFO - [MainThread] 处理第15个报文的第0个HEADERS帧
2025-05-20 19:13:10,500 - INFO - [MainThread] 对第15个报文使用二进制替换方法
2025-05-20 19:13:10,500 - INFO - [MainThread] 特殊处理第15号报文 - 确保location正确且content-length存在
2025-05-20 19:13:10,500 - ERROR - [MainThread] 解码第15号报文头部失败: Invalid table index 63，将使用二进制替换方法
2025-05-20 19:13:10,501 - ERROR - [MainThread] 解析HEADERS错误: Invalid table index 63
2025-05-20 19:13:10,501 - INFO - [MainThread] 第15号报文DATA帧长度: 353
2025-05-20 19:13:10,501 - INFO - [MainThread] 第15号报文DATA帧长度: 0
2025-05-20 19:13:10,501 - INFO - [MainThread] 替换 cnTunnelInfo: {'ipv4Addr': '30.0.0.2', 'gtpTeid': '00000001'} -> {'ipv4Addr': '20.0.0.1', 'gtpTeid': '50000001'}
2025-05-20 19:13:10,501 - INFO - [MainThread] 替换 uplink: 5.000 Gbps -> 5000000000
2025-05-20 19:13:10,501 - INFO - [MainThread] 替换 downlink: 5.000 Gbps -> 5000000000
2025-05-20 19:13:10,501 - INFO - [MainThread] 替换 ueIpv4Address: 30.30.30.20 -> 100.0.0.1
2025-05-20 19:13:10,501 - INFO - [MainThread] JSON数据已修改
2025-05-20 19:13:10,501 - INFO - [MainThread] 第15个报文DATA帧已修改，新长度: 351
2025-05-20 19:13:10,502 - WARNING - [MainThread] 第15号报文没有content-length帧，尝试强制添加
2025-05-20 19:13:10,502 - INFO - [MainThread] 在第15个报文的HEADERS帧中添加缺失的content-length字段
2025-05-20 19:13:10,502 - INFO - [MainThread] 第15个报文已通过帧处理修改
2025-05-20 19:13:10,502 - INFO - [MainThread] ===== 第15号报文修改后验证 =====
2025-05-20 19:13:10,502 - WARNING - [MainThread] 修改后第15号报文未找到location字段
2025-05-20 19:13:10,502 - WARNING - [MainThread] 修改后第15号报文未找到content-length字段
2025-05-20 19:13:10,502 - INFO - [MainThread] ===== 第15号报文调试信息结束 =====
2025-05-20 19:13:10,502 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,503 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,503 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 19:13:10,503 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 19:13:10,504 - INFO - [MainThread] 保存修改后的PCAP到 pcap/N16_1425.pcap
2025-05-20 19:13:10,509 - INFO - [MainThread] 处理完成，共处理 16 个报文
