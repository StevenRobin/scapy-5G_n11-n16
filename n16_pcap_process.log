2025-05-20 22:09:58,462 - INFO - [MainThread] 开始处理文件 pcap/N16_create_16p.pcap
2025-05-20 22:09:58,466 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,466 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,467 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,467 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,468 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,468 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,469 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,469 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,470 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,470 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,471 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,471 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,472 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,472 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,473 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,473 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,475 - INFO - [MainThread] 特殊处理第9个报文
2025-05-20 22:09:58,476 - INFO - [MainThread] 处理第9个报文的第1个HEADERS帧
2025-05-20 22:09:58,476 - INFO - [MainThread] 对第9个报文使用二进制替换方法
2025-05-20 22:09:58,476 - INFO - [MainThread] 替换:authority: 200.20.20.25:8080 -> 30.0.0.1
2025-05-20 22:09:58,477 - INFO - [MainThread] 替换:path: /nsmf-pdusession/v1/sm-contexts/1722077971/retrieve -> /nsmf-pdusession/v1/sm-contexts/9000000001/retrieve
2025-05-20 22:09:58,477 - INFO - [MainThread] HEADERS已修改，新长度: 64
2025-05-20 22:09:58,478 - INFO - [MainThread] 第9个报文已通过帧处理修改
2025-05-20 22:09:58,478 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,478 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,479 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,480 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,481 - INFO - [MainThread] 特殊处理第11个报文
2025-05-20 22:09:58,481 - INFO - [MainThread] 处理第11个报文的第0个HEADERS帧
2025-05-20 22:09:58,481 - INFO - [MainThread] 对第11个报文使用二进制替换方法
2025-05-20 22:09:58,482 - INFO - [MainThread] 特殊处理第11号报文
2025-05-20 22:09:58,482 - INFO - [MainThread] 使用额外的强制替换方法确保authority字段正确
2025-05-20 22:09:58,482 - INFO - [MainThread] 替换 dnn: dnn-0000 -> dnn600000001
2025-05-20 22:09:58,483 - INFO - [MainThread] 替换 gpsi: msisdn-8611111111111 -> msisdn-8613900000001
2025-05-20 22:09:58,483 - INFO - [MainThread] 替换 ueIpv4Address: 30.30.30.20 -> 100.0.0.1
2025-05-20 22:09:58,483 - INFO - [MainThread] JSON数据已修改
2025-05-20 22:09:58,483 - INFO - [MainThread] 第11个报文DATA帧已修改，新长度: 350
2025-05-20 22:09:58,484 - INFO - [MainThread] 更新Content-Length: 348 -> 350
2025-05-20 22:09:58,484 - INFO - [MainThread] 第11个报文的content-length已更新
2025-05-20 22:09:58,484 - INFO - [MainThread] 第11个报文已通过帧处理修改
2025-05-20 22:09:58,485 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,485 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,486 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,486 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,487 - INFO - [MainThread] 特殊处理第13个报文
2025-05-20 22:09:58,487 - INFO - [MainThread] 处理第13个报文的第0个HEADERS帧
2025-05-20 22:09:58,487 - INFO - [MainThread] 对第13个报文使用二进制替换方法
2025-05-20 22:09:58,488 - INFO - [MainThread] 特殊处理第13号报文 - 确保content-type存在且头部正确
2025-05-20 22:09:58,488 - INFO - [MainThread] 添加默认content-type: application/json
2025-05-20 22:09:58,488 - INFO - [MainThread] 为第13号报文创建了最小化头部，新长度: 48
2025-05-20 22:09:58,488 - ERROR - [MainThread] 解析HEADERS错误: Invalid table index 63
2025-05-20 22:09:58,489 - INFO - [MainThread] 替换 supi: imsi-460011357924680 -> imsi-460012300000001
2025-05-20 22:09:58,489 - INFO - [MainThread] 替换 pei: imeisv-8611111111111111 -> imeisv-8611101000000011
2025-05-20 22:09:58,489 - INFO - [MainThread] 替换 dnn: dnn-0000 -> dnn600000001
2025-05-20 22:09:58,489 - INFO - [MainThread] 替换 ismfId: c251849c-681e-48ba-918b-ae0200867718 -> c251849c-681e-48ba-918b-000500000001
2025-05-20 22:09:58,490 - INFO - [MainThread] 替换 ismfPduSessionUri: http://200.20.20.26:8080/nsmf-pdusession/v1/pdu-sessions/461977034 -> http://40.0.0.1/nsmf-pdusession/v1/pdu-sessions/10000001
2025-05-20 22:09:58,490 - INFO - [MainThread] 替换 icnTunnelInfo: {'ipv4Addr': '30.0.0.3', 'gtpTeid': '00000001'} -> {'ipv4Addr': '10.0.0.1', 'gtpTeid': '10000001'}
2025-05-20 22:09:58,490 - INFO - [MainThread] 替换 nrCellId: 00011c006 -> 010000001
2025-05-20 22:09:58,490 - INFO - [MainThread] 替换 gpsi: msisdn-8611111111111 -> msisdn-8613900000001
2025-05-20 22:09:58,491 - INFO - [MainThread] JSON数据已修改
2025-05-20 22:09:58,491 - INFO - [MainThread] 第13个报文DATA帧已修改，新长度: 703
2025-05-20 22:09:58,491 - INFO - [MainThread] 在第13个报文的HEADERS帧中添加缺失的content-length字段
2025-05-20 22:09:58,491 - INFO - [MainThread] 添加Content-Length: 703
2025-05-20 22:09:58,491 - INFO - [MainThread] 已在第13个报文中添加content-length: 703
2025-05-20 22:09:58,492 - INFO - [MainThread] 第13个报文已通过帧处理修改
2025-05-20 22:09:58,492 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,492 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,494 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,495 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,496 - INFO - [MainThread] 特殊处理第15个报文
2025-05-20 22:09:58,496 - INFO - [MainThread] 处理第15个报文的第0个HEADERS帧
2025-05-20 22:09:58,496 - INFO - [MainThread] 对第15个报文使用二进制替换方法
2025-05-20 22:09:58,497 - INFO - [MainThread] 特殊处理第15号报文 - 确保location正确且content-length存在
2025-05-20 22:09:58,497 - ERROR - [MainThread] 解码第15号报文头部失败: Invalid table index 63，将使用二进制替换方法
2025-05-20 22:09:58,498 - ERROR - [MainThread] 解析HEADERS错误: Invalid table index 63
2025-05-20 22:09:58,498 - INFO - [MainThread] 替换 cnTunnelInfo: {'ipv4Addr': '30.0.0.2', 'gtpTeid': '00000001'} -> {'ipv4Addr': '20.0.0.1', 'gtpTeid': '50000001'}
2025-05-20 22:09:58,498 - INFO - [MainThread] 替换 uplink: 5.000 Gbps -> 5000000000
2025-05-20 22:09:58,498 - INFO - [MainThread] 替换 downlink: 5.000 Gbps -> 5000000000
2025-05-20 22:09:58,498 - INFO - [MainThread] 替换 ueIpv4Address: 30.30.30.20 -> 100.0.0.1
2025-05-20 22:09:58,499 - INFO - [MainThread] JSON数据已修改
2025-05-20 22:09:58,499 - INFO - [MainThread] 第15个报文DATA帧已修改，新长度: 351
2025-05-20 22:09:58,499 - WARNING - [MainThread] 第15号报文没有content-length帧，尝试强制添加
2025-05-20 22:09:58,499 - INFO - [MainThread] 在第15个报文的HEADERS帧中添加缺失的content-length字段
2025-05-20 22:09:58,500 - INFO - [MainThread] 第15个报文已通过帧处理修改
2025-05-20 22:09:58,500 - INFO - [MainThread] 替换源IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,500 - INFO - [MainThread] 替换目的IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,501 - INFO - [MainThread] 替换源IP 200.20.20.26 -> 30.0.0.1
2025-05-20 22:09:58,501 - INFO - [MainThread] 替换目的IP 200.20.20.25 -> 40.0.0.1
2025-05-20 22:09:58,502 - INFO - [MainThread] 保存修改后的PCAP到 pcap/N16_1427.pcap
2025-05-20 22:09:58,514 - INFO - [MainThread] 处理完成，共处理 16 个报文
